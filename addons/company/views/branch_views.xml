<?xml version="1.0" encoding="utf-8"?>
<ocean>
    <data>
        <!-- Branches Tree View -->
        <record id="view_branches_tree" model="ocean.ui.view">
            <field name="name">branches.tree</field>
            <field name="model">company.branch</field>
            <field name="arch" type="xml">
                <tree string="Branches" decoration-muted="not is_active" decoration-info="is_default">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="company_id"/>
                    <field name="branch_type"/>
                    <field name="parent_branch_id"/>
                    <field name="manager_id"/>
                    <field name="current_users"/>
                    <field name="max_users"/>
                    <field name="is_active"/>
                    <field name="is_default"/>
                </tree>
            </field>
        </record>
        
        <!-- Branches Form View -->
        <record id="view_branches_form" model="ocean.ui.view">
            <field name="name">branches.form</field>
            <field name="model">company.branch</field>
            <field name="arch" type="xml">
                <form string="Branch">
                    <header>
                        <button name="action_activate" string="Activate" type="object" class="btn-primary" attrs="{'invisible': [('is_active', '=', True)]}"/>
                        <button name="action_deactivate" string="Deactivate" type="object" class="btn-warning" attrs="{'invisible': [('is_active', '=', False)]}"/>
                        <button name="action_set_default" string="Set as Default" type="object" class="btn-secondary" attrs="{'invisible': [('is_default', '=', True)]}"/>
                        <button name="action_duplicate" string="Duplicate" type="object" class="btn-info"/>
                        <field name="is_active" widget="statusbar" statusbar_visible="False,True"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name" placeholder="Branch Name"/>
                            </h1>
                        </div>
                        
                        <group>
                            <group string="Basic Information">
                                <field name="code"/>
                                <field name="description"/>
                                <field name="company_id"/>
                                <field name="branch_type"/>
                                <field name="parent_branch_id"/>
                                <field name="branch_level"/>
                            </group>
                            <group string="Contact Information">
                                <field name="phone"/>
                                <field name="mobile"/>
                                <field name="email"/>
                                <field name="website"/>
                                <field name="manager_id"/>
                            </group>
                        </group>
                        
                        <group>
                            <group string="Address">
                                <field name="street"/>
                                <field name="street2"/>
                                <field name="city"/>
                                <field name="state_id"/>
                                <field name="zip"/>
                                <field name="country_id"/>
                            </group>
                            <group string="Branch Settings">
                                <field name="is_active"/>
                                <field name="is_default"/>
                                <field name="max_users"/>
                                <field name="current_users"/>
                            </group>
                        </group>
                        
                        <group>
                            <group string="Branch Features">
                                <field name="enable_pos"/>
                                <field name="enable_inventory"/>
                                <field name="enable_sales"/>
                                <field name="enable_purchase"/>
                            </group>
                            <group string="Branch Analytics">
                                <field name="total_sales"/>
                                <field name="total_orders"/>
                            </group>
                        </group>
                        
                        <notebook>
                            <page string="Users" name="users">
                                <field name="user_ids" widget="many2many_tags"/>
                            </page>
                            
                            <page string="Locations" name="locations">
                                <field name="location_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="code"/>
                                        <field name="location_type"/>
                                        <field name="manager_id"/>
                                        <field name="is_active"/>
                                    </tree>
                                </field>
                            </page>
                            
                            <page string="Child Branches" name="children">
                                <field name="child_branch_ids" nolabel="1">
                                    <tree>
                                        <field name="name"/>
                                        <field name="code"/>
                                        <field name="branch_type"/>
                                        <field name="manager_id"/>
                                        <field name="is_active"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Branches Search View -->
        <record id="view_branches_search" model="ocean.ui.view">
            <field name="name">branches.search</field>
            <field name="model">company.branch</field>
            <field name="arch" type="xml">
                <search string="Search Branches">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="description"/>
                    <field name="company_id"/>
                    <field name="branch_type"/>
                    <field name="manager_id"/>
                    <filter string="Active Branches" name="active" domain="[('is_active', '=', True)]"/>
                    <filter string="Inactive Branches" name="inactive" domain="[('is_active', '=', False)]"/>
                    <filter string="Default Branches" name="default" domain="[('is_default', '=', True)]"/>
                    <filter string="Head Office" name="head_office" domain="[('branch_type', '=', 'head_office')]"/>
                    <filter string="Regional Office" name="regional_office" domain="[('branch_type', '=', 'regional_office')]"/>
                    <filter string="Branch Office" name="branch_office" domain="[('branch_type', '=', 'branch_office')]"/>
                    <filter string="Warehouse" name="warehouse" domain="[('branch_type', '=', 'warehouse')]"/>
                    <filter string="Showroom" name="showroom" domain="[('branch_type', '=', 'showroom')]"/>
                    <filter string="Franchise" name="franchise" domain="[('branch_type', '=', 'franchise')]"/>
                    <filter string="Distributor" name="distributor" domain="[('branch_type', '=', 'distributor')]"/>
                    <group expand="0" string="Group By">
                        <filter string="Company" name="group_company" context="{'group_by': 'company_id'}"/>
                        <filter string="Branch Type" name="group_branch_type" context="{'group_by': 'branch_type'}"/>
                        <filter string="Manager" name="group_manager" context="{'group_by': 'manager_id'}"/>
                        <filter string="Parent Branch" name="group_parent" context="{'group_by': 'parent_branch_id'}"/>
                        <filter string="Created Date" name="group_create_date" context="{'group_by': 'create_date:day'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- Branches Action -->
        <record id="action_branches" model="ocean.actions.act_window">
            <field name="name">Branches</field>
            <field name="res_model">company.branch</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_branches_tree"/>
            <field name="search_view_id" ref="view_branches_search"/>
            <field name="context">{'search_default_active': 1}</field>
        </record>
        
    </data>
</ocean>