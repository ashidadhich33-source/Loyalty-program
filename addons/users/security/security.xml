<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Security Groups -->
        <record id="group_user_management" model="res.groups">
            <field name="name">User Management</field>
            <field name="category_id" ref="base.module_category_administration"/>
            <field name="comment">User management and administration</field>
        </record>
        
        <record id="group_user_administration" model="res.groups">
            <field name="name">User Administration</field>
            <field name="category_id" ref="base.module_category_administration"/>
            <field name="comment">Full user administration rights</field>
        </record>
        
        <record id="group_permission_management" model="res.groups">
            <field name="name">Permission Management</field>
            <field name="category_id" ref="base.module_category_administration"/>
            <field name="comment">Permission and access right management</field>
        </record>
        
        <record id="group_activity_monitoring" model="res.groups">
            <field name="name">Activity Monitoring</field>
            <field name="category_id" ref="base.module_category_administration"/>
            <field name="comment">User activity monitoring and analytics</field>
        </record>
        
        <!-- Security Rules -->
        <record id="rule_res_users_own_record" model="ir.rule">
            <field name="name">Users: Own Record</field>
            <field name="model_id" ref="model_res_users"/>
            <field name="domain_force">[('id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_res_users_company" model="ir.rule">
            <field name="name">Users: Company</field>
            <field name="model_id" ref="model_res_users"/>
            <field name="domain_force">[('company_ids', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_user_management'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_user_permissions_own" model="ir.rule">
            <field name="name">User Permissions: Own</field>
            <field name="model_id" ref="model_user_permissions"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_user_permissions_company" model="ir.rule">
            <field name="name">User Permissions: Company</field>
            <field name="model_id" ref="model_user_permissions"/>
            <field name="domain_force">[('user_id.company_ids', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_permission_management'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
        
        <record id="rule_access_rights_own" model="ir.rule">
            <field name="name">Access Rights: Own</field>
            <field name="model_id" ref="model_access_rights"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_access_rights_company" model="ir.rule">
            <field name="name">Access Rights: Company</field>
            <field name="model_id" ref="model_access_rights"/>
            <field name="domain_force">[('user_id.company_ids', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_permission_management'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
        
        <record id="rule_user_activity_own" model="ir.rule">
            <field name="name">User Activity: Own</field>
            <field name="model_id" ref="model_user_activity"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_user_activity_company" model="ir.rule">
            <field name="name">User Activity: Company</field>
            <field name="model_id" ref="model_user_activity"/>
            <field name="domain_force">[('user_id.company_ids', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_activity_monitoring'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <record id="rule_user_preferences_own" model="ir.rule">
            <field name="name">User Preferences: Own</field>
            <field name="model_id" ref="model_user_preferences"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
        
        <record id="rule_user_preferences_company" model="ir.rule">
            <field name="name">User Preferences: Company</field>
            <field name="model_id" ref="model_user_preferences"/>
            <field name="domain_force">[('user_id.company_ids', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_user_management'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
        
    </data>
</odoo>