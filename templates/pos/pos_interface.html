<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS Interface - Ocean ERP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .pos-container {
            height: 100vh;
            background: #f8f9fa;
        }
        .pos-sidebar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            overflow-y: auto;
        }
        .pos-main {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .pos-header {
            background: white;
            border-bottom: 1px solid #dee2e6;
            padding: 15px 20px;
        }
        .pos-content {
            flex: 1;
            display: flex;
        }
        .pos-products {
            flex: 1;
            background: white;
            margin: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .pos-cart {
            width: 400px;
            background: white;
            margin: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .product-card {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .product-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }
        .cart-item {
            border-bottom: 1px solid #dee2e6;
            padding: 15px;
        }
        .cart-item:last-child {
            border-bottom: none;
        }
        .barcode-input {
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            font-size: 18px;
            text-align: center;
            background: #f8f9ff;
        }
        .barcode-input:focus {
            border-color: #28a745;
            box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
        }
        .btn-pos {
            border-radius: 10px;
            padding: 12px 20px;
            font-weight: 600;
        }
        .btn-primary-pos {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        .btn-success-pos {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            border: none;
        }
        .btn-warning-pos {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
        }
        .gst-breakdown {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .payment-methods {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        .payment-method {
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .payment-method:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        .payment-method.active {
            border-color: #28a745;
            background: #f0fff4;
        }
        .customer-info {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .discount-input {
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 10px;
            background: #fffbf0;
        }
        .session-info {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .cart-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="pos-container">
        <div class="row g-0 h-100">
            <!-- Sidebar -->
            <div class="col-md-3 pos-sidebar">
                <div class="p-3">
                    <div class="d-flex align-items-center mb-4">
                        <div class="bg-white rounded-circle p-2 me-3">
                            <i class="fas fa-water text-primary"></i>
                        </div>
                        <div>
                            <h5 class="mb-0">Ocean ERP</h5>
                            <small class="opacity-75">POS System</small>
                        </div>
                    </div>
                    
                    <!-- Session Info -->
                    <div class="session-info">
                        <h6 class="mb-2"><i class="fas fa-clock me-2"></i>Session Info</h6>
                        <small class="d-block">Session: POS-2024-001</small>
                        <small class="d-block">Cashier: Admin User</small>
                        <small class="d-block">Start: 09:00 AM</small>
                        <small class="d-block">Orders: 15</small>
                    </div>
                    
                    <!-- Customer Info -->
                    <div class="customer-info">
                        <h6 class="mb-2"><i class="fas fa-user me-2"></i>Customer</h6>
                        <div class="mb-2">
                            <select class="form-select form-select-sm" id="customerSelect">
                                <option value="">Select Customer</option>
                                <option value="guest">Guest Customer</option>
                                <option value="1">Rajesh Kumar</option>
                                <option value="2">Priya Sharma</option>
                                <option value="3">Amit Patel</option>
                            </select>
                        </div>
                        <div class="mb-2">
                            <button class="btn btn-outline-light btn-sm w-100" onclick="addNewCustomer()">
                                <i class="fas fa-plus me-2"></i>New Customer
                            </button>
                        </div>
                        <div id="customerDetails" style="display: none;">
                            <small class="d-block">Name: Rajesh Kumar</small>
                            <small class="d-block">Mobile: 9876543210</small>
                            <small class="d-block">Type: Registered</small>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="mt-4">
                        <h6 class="mb-3"><i class="fas fa-bolt me-2"></i>Quick Actions</h6>
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-light btn-sm" onclick="openInventory()">
                                <i class="fas fa-warehouse me-2"></i>Inventory
                            </button>
                            <button class="btn btn-outline-light btn-sm" onclick="openReports()">
                                <i class="fas fa-chart-bar me-2"></i>Reports
                            </button>
                            <button class="btn btn-outline-light btn-sm" onclick="openSettings()">
                                <i class="fas fa-cog me-2"></i>Settings
                            </button>
                            <button class="btn btn-outline-light btn-sm" onclick="closeSession()">
                                <i class="fas fa-sign-out-alt me-2"></i>Close Session
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 pos-main">
                <!-- Header -->
                <div class="pos-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h4 class="mb-0">POS Terminal</h4>
                            <small class="text-muted">Ocean Kids Store - Terminal 1</small>
                        </div>
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <small class="text-muted">Date: 01 Dec 2024</small><br>
                                <small class="text-muted">Time: 10:30 AM</small>
                            </div>
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user me-2"></i>Admin User
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="/profile"><i class="fas fa-user me-2"></i>Profile</a></li>
                                    <li><a class="dropdown-item" href="/settings"><i class="fas fa-cog me-2"></i>Settings</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="/logout"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content -->
                <div class="pos-content">
                    <!-- Products Section -->
                    <div class="pos-products">
                        <div class="p-3">
                            <!-- Barcode Scanner -->
                            <div class="mb-3">
                                <input type="text" class="form-control barcode-input" id="barcodeInput" 
                                       placeholder="Scan or enter barcode..." autofocus>
                            </div>
                            
                            <!-- Product Search -->
                            <div class="mb-3">
                                <div class="input-group">
                                    <input type="text" class="form-control" id="productSearch" 
                                           placeholder="Search products...">
                                    <button class="btn btn-outline-primary" type="button">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Products Grid -->
                            <div class="row" id="productsGrid">
                                <!-- Product cards will be dynamically loaded -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cart Section -->
                    <div class="pos-cart">
                        <div class="p-3">
                            <h5 class="mb-3"><i class="fas fa-shopping-cart me-2"></i>Shopping Cart</h5>
                            
                            <!-- Cart Items -->
                            <div id="cartItems" class="mb-3">
                                <!-- Cart items will be dynamically loaded -->
                            </div>
                            
                            <!-- Cart Summary -->
                            <div class="cart-summary">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Subtotal:</span>
                                    <span>₹1,499.00</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Discount:</span>
                                    <span class="text-success">-₹149.90</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>CGST (2.5%):</span>
                                    <span>₹32.12</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>SGST (2.5%):</span>
                                    <span>₹32.12</span>
                                </div>
                                <hr>
                                <div class="d-flex justify-content-between mb-3">
                                    <strong>Total:</strong>
                                    <strong>₹1,413.34</strong>
                                </div>
                            </div>
                            
                            <!-- Discount -->
                            <div class="mb-3">
                                <label class="form-label">Discount</label>
                                <div class="input-group">
                                    <input type="number" class="form-control discount-input" 
                                           placeholder="10" step="0.01">
                                    <select class="form-select">
                                        <option value="percentage">%</option>
                                        <option value="fixed">₹</option>
                                    </select>
                                    <button class="btn btn-warning-pos btn-sm" type="button">
                                        <i class="fas fa-percentage"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Payment Methods -->
                            <div class="mb-3">
                                <label class="form-label">Payment Method</label>
                                <div class="payment-methods">
                                    <div class="payment-method active" data-method="cash">
                                        <i class="fas fa-money-bill-wave fa-2x mb-2"></i>
                                        <div>Cash</div>
                                    </div>
                                    <div class="payment-method" data-method="card">
                                        <i class="fas fa-credit-card fa-2x mb-2"></i>
                                        <div>Card</div>
                                    </div>
                                    <div class="payment-method" data-method="upi">
                                        <i class="fas fa-mobile-alt fa-2x mb-2"></i>
                                        <div>UPI</div>
                                    </div>
                                    <div class="payment-method" data-method="mixed">
                                        <i class="fas fa-exchange-alt fa-2x mb-2"></i>
                                        <div>Mixed</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Payment Amount -->
                            <div class="mb-3">
                                <label class="form-label">Amount Received</label>
                                <div class="input-group">
                                    <span class="input-group-text">₹</span>
                                    <input type="number" class="form-control" id="amountReceived" 
                                           placeholder="1413.34" step="0.01">
                                </div>
                                <div class="form-text">Change: ₹0.00</div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="d-grid gap-2">
                                <button class="btn btn-success-pos btn-pos" onclick="processPayment()">
                                    <i class="fas fa-check me-2"></i>Process Payment
                                </button>
                                <button class="btn btn-warning-pos btn-pos" onclick="modifyBill()">
                                    <i class="fas fa-edit me-2"></i>Modify Bill
                                </button>
                                <button class="btn btn-outline-secondary btn-pos" onclick="clearCart()">
                                    <i class="fas fa-trash me-2"></i>Clear Cart
                                </button>
                                <button class="btn btn-outline-primary btn-pos" onclick="reprintReceipt()">
                                    <i class="fas fa-print me-2"></i>Reprint Receipt
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample products data
        const products = [
            {
                id: 1,
                barcode: '685686043632',
                name: 'Boys Blue Slim Fit Jeans',
                size: '18',
                color: 'BLUE',
                mrp: 1499.00,
                cost_price: 843.79,
                gst_rate: 5.00,
                stock: 25
            },
            {
                id: 2,
                barcode: '685686043633',
                name: 'Boys Blue Slim Fit Jeans',
                size: '20',
                color: 'BLUE',
                mrp: 1499.00,
                cost_price: 843.79,
                gst_rate: 5.00,
                stock: 20
            },
            {
                id: 3,
                barcode: '685686043634',
                name: 'Boys Blue Slim Fit Jeans',
                size: '22',
                color: 'BLUE',
                mrp: 1499.00,
                cost_price: 843.79,
                gst_rate: 5.00,
                stock: 15
            },
            {
                id: 4,
                barcode: '685686043635',
                name: 'Boys Blue Slim Fit Jeans',
                size: '24',
                color: 'BLUE',
                mrp: 1699.00,
                cost_price: 956.37,
                gst_rate: 5.00,
                stock: 10
            }
        ];
        
        let cart = [];
        let selectedPaymentMethod = 'cash';
        
        // Initialize POS
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupEventListeners();
        });
        
        // Load products
        function loadProducts() {
            const productsGrid = document.getElementById('productsGrid');
            productsGrid.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'col-md-6 col-lg-4';
                productCard.innerHTML = `
                    <div class="product-card" onclick="addToCart(${product.id})">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="mb-0">${product.name}</h6>
                            <span class="badge bg-primary">${product.size}</span>
                        </div>
                        <div class="mb-2">
                            <small class="text-muted">${product.color} | ${product.barcode}</small>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-bold">₹${product.mrp.toFixed(2)}</div>
                                <small class="text-muted">GST: ${product.gst_rate}%</small>
                            </div>
                            <div class="text-end">
                                <small class="text-muted">Stock: ${product.stock}</small>
                            </div>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Barcode input
            document.getElementById('barcodeInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const barcode = this.value.trim();
                    if (barcode) {
                        addProductByBarcode(barcode);
                        this.value = '';
                    }
                }
            });
            
            // Payment method selection
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
                    this.classList.add('active');
                    selectedPaymentMethod = this.dataset.method;
                });
            });
            
            // Amount received calculation
            document.getElementById('amountReceived').addEventListener('input', function() {
                const received = parseFloat(this.value) || 0;
                const total = getCartTotal();
                const change = received - total;
                this.nextElementSibling.textContent = `Change: ₹${change.toFixed(2)}`;
            });
        }
        
        // Add product by barcode
        function addProductByBarcode(barcode) {
            const product = products.find(p => p.barcode === barcode);
            if (product) {
                addToCart(product.id);
            } else {
                alert('Product not found!');
            }
        }
        
        // Add to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        ...product,
                        quantity: 1,
                        discount: 0,
                        discount_type: 'percentage'
                    });
                }
                updateCartDisplay();
            }
        }
        
        // Update cart display
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            cartItems.innerHTML = '';
            
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            <h6 class="mb-0">${item.name}</h6>
                            <small class="text-muted">${item.color} | Size ${item.size}</small>
                        </div>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="input-group input-group-sm" style="width: 120px;">
                            <button class="btn btn-outline-secondary" onclick="updateQuantity(${item.id}, -1)">-</button>
                            <input type="number" class="form-control text-center" value="${item.quantity}" 
                                   onchange="setQuantity(${item.id}, this.value)">
                            <button class="btn btn-outline-secondary" onclick="updateQuantity(${item.id}, 1)">+</button>
                        </div>
                        <div class="text-end">
                            <div class="fw-bold">₹${(item.mrp * item.quantity).toFixed(2)}</div>
                            <small class="text-muted">₹${item.mrp.toFixed(2)} each</small>
                        </div>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });
            
            updateCartSummary();
        }
        
        // Update cart summary
        function updateCartSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.mrp * item.quantity), 0);
            const discount = cart.reduce((sum, item) => sum + (item.discount || 0), 0);
            const discountedTotal = subtotal - discount;
            const gstRate = 5.00; // Default GST rate
            const baseAmount = discountedTotal / (1 + gstRate / 100);
            const cgst = baseAmount * (gstRate / 2 / 100);
            const sgst = baseAmount * (gstRate / 2 / 100);
            const total = discountedTotal;
            
            // Update summary display
            const summary = document.querySelector('.cart-summary');
            summary.innerHTML = `
                <div class="d-flex justify-content-between mb-2">
                    <span>Subtotal:</span>
                    <span>₹${subtotal.toFixed(2)}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Discount:</span>
                    <span class="text-success">-₹${discount.toFixed(2)}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>CGST (2.5%):</span>
                    <span>₹${cgst.toFixed(2)}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>SGST (2.5%):</span>
                    <span>₹${sgst.toFixed(2)}</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between mb-3">
                    <strong>Total:</strong>
                    <strong>₹${total.toFixed(2)}</strong>
                </div>
            `;
        }
        
        // Get cart total
        function getCartTotal() {
            const subtotal = cart.reduce((sum, item) => sum + (item.mrp * item.quantity), 0);
            const discount = cart.reduce((sum, item) => sum + (item.discount || 0), 0);
            return subtotal - discount;
        }
        
        // Update quantity
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity = Math.max(1, item.quantity + change);
                updateCartDisplay();
            }
        }
        
        // Set quantity
        function setQuantity(productId, quantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity = Math.max(1, parseInt(quantity));
                updateCartDisplay();
            }
        }
        
        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }
        
        // Process payment
        function processPayment() {
            if (cart.length === 0) {
                alert('Cart is empty!');
                return;
            }
            
            const total = getCartTotal();
            const received = parseFloat(document.getElementById('amountReceived').value) || 0;
            
            if (received < total) {
                alert('Amount received is less than total amount!');
                return;
            }
            
            // Show payment processing
            const paymentBtn = document.querySelector('button[onclick="processPayment()"]');
            const originalText = paymentBtn.innerHTML;
            paymentBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
            paymentBtn.disabled = true;
            
            // Simulate payment processing
            setTimeout(() => {
                // Generate receipt
                generateReceipt();
                
                // Clear cart
                cart = [];
                updateCartDisplay();
                document.getElementById('amountReceived').value = '';
                
                // Reset button
                paymentBtn.innerHTML = originalText;
                paymentBtn.disabled = false;
                
                alert('Payment processed successfully! Receipt generated.');
            }, 2000);
        }
        
        // Generate receipt
        function generateReceipt() {
            const receipt = {
                orderNumber: 'POS-2024-001',
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString(),
                items: cart,
                total: getCartTotal(),
                paymentMethod: selectedPaymentMethod,
                amountReceived: parseFloat(document.getElementById('amountReceived').value) || 0
            };
            
            console.log('Receipt:', receipt);
            // In real implementation, this would be sent to the server
        }
        
        // Modify bill
        function modifyBill() {
            if (cart.length === 0) {
                alert('Cart is empty!');
                return;
            }
            
            // Show modify bill modal or form
            alert('Modify Bill functionality - Add/Remove items, change quantities, apply discounts');
        }
        
        // Clear cart
        function clearCart() {
            if (cart.length === 0) {
                alert('Cart is already empty!');
                return;
            }
            
            if (confirm('Are you sure you want to clear the cart?')) {
                cart = [];
                updateCartDisplay();
                document.getElementById('amountReceived').value = '';
            }
        }
        
        // Reprint receipt
        function reprintReceipt() {
            alert('Reprint Receipt functionality - Show last receipt for reprinting');
        }
        
        // Customer functions
        function addNewCustomer() {
            alert('Add New Customer functionality - Open customer registration form');
        }
        
        // Quick action functions
        function openInventory() {
            window.open('/inventory/stock', '_blank');
        }
        
        function openReports() {
            window.open('/reports/gst', '_blank');
        }
        
        function openSettings() {
            window.open('/settings', '_blank');
        }
        
        function closeSession() {
            if (confirm('Are you sure you want to close the POS session?')) {
                alert('Session closed successfully!');
                window.location.href = '/dashboard';
            }
        }
        
        // Customer selection
        document.getElementById('customerSelect').addEventListener('change', function() {
            const customerId = this.value;
            const customerDetails = document.getElementById('customerDetails');
            
            if (customerId === '1') {
                customerDetails.style.display = 'block';
                customerDetails.innerHTML = `
                    <small class="d-block">Name: Rajesh Kumar</small>
                    <small class="d-block">Mobile: 9876543210</small>
                    <small class="d-block">Type: Registered</small>
                `;
            } else if (customerId === 'guest') {
                customerDetails.style.display = 'block';
                customerDetails.innerHTML = `
                    <small class="d-block">Name: Guest Customer</small>
                    <small class="d-block">Mobile: Not provided</small>
                    <small class="d-block">Type: Guest</small>
                `;
            } else {
                customerDetails.style.display = 'none';
            }
        });
    </script>
</body>
</html>